---
import BaseLayout from '../layouts/BaseLayout.astro';
import Navbar from '../components/global/Navbar.astro';
import HeroSimple from '../components/modules/HeroSimple.astro';
import FeatureGrid from '../components/modules/FeatureGrid.astro';
import MasonryGallery from '../components/modules/MasonryGallery.astro';

import { sanityClient } from "sanity:client";
import imageUrlBuilder from "@sanity/image-url";

const builder = imageUrlBuilder(sanityClient);
function urlFor(source: any) {
  return builder.image(source);
}

const heroData = await sanityClient.fetch(`*[_type == "hero"][0]`);
const heroImage = heroData?.bgImage ? urlFor(heroData.bgImage).width(2000).url() : null;
---

<BaseLayout title="My Modular Studio">
  <Navbar />

  {heroData && (
    <HeroSimple 
      headline={heroData.headline}
      subheadline={heroData.subheadline}
      buttonText={heroData.buttonText}
      backgroundImage={heroImage}
    />
  )}

  <MasonryGallery />

  <FeatureGrid />

</BaseLayout>